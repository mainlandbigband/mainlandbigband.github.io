<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Limelight" rel="stylesheet">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#b10f24">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="theme-color" content="#ffffff">

    <title>{{ .Site.Title }}: {{ .Title }}</title>

    <style>
        .logo {
            position: absolute;
            top: 0;
            z-index: 1;
            height: 75%;
        }

        .nav-pills .nav-link.active {
            background-color: black;
            color: white;
        }

        .nav-link {
            color: black;
        }

        .nav {
            text-transform: uppercase;
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .nav, h1, h2, h3 {
            font-family: 'Limelight', cursive;
        }

        .container {
            padding-left: 1em;
            padding-right: 1em;
            background-color: white;
        }

        body {
            background: #b10f24 url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 8.996 8.996"><path opacity=".12" fill="none" stroke="%23000" stroke-width=".182" d="M-.004 4.498L4.498-.003l4.501 4.501L4.498 9z"/></svg>');
        }
        
        .lazy-carousel-item {
            display: none;
        }

        a:hover {
            color: #d83f39;
        }

        .footer * {
            vertical-align: sub;
        }
        
        body section {
            margin-bottom: 2em;
        }
        
        form {
            margin-bottom: 2em;
        }

    </style>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-12">
            <div id="headerCarousel" class="carousel slide" data-ride="carousel" data-interval="8000">
                <div class="carousel-inner">
                    {{ with .Site.GetPage "section" "carousel" }}
                        {{ $.Scratch.Set "firstCarouselImage" true }}
                        {{ with .Resources.ByType "image" }}
                            {{ range . }}
                            {{ $scaledHi := .Fill "2160x892 Top"}}
                            {{ $scaledMed := .Fill "1080x446 Top"}}
                            {{ $scaledLo := .Fill "540x223 Top"}}
                            <div class='{{ if not ($.Scratch.Get "firstCarouselImage")}}lazy-{{ end }}carousel-item {{ if $.Scratch.Get "firstCarouselImage"}}active{{ end }}'>
                                <img class="d-block w-100" 
                                     {{ if not ($.Scratch.Get "firstCarouselImage")}}data-lazy-{{ end }}src="{{ $scaledMed.RelPermalink }}" 
                                     {{ if not ($.Scratch.Get "firstCarouselImage")}}data-lazy-{{ end }}srcset="{{ $scaledLo.RelPermalink }} 540w, {{ $scaledMed.RelPermalink }} 1080w, {{ $scaledHi.RelPermalink }} 2160w" 
                                    alt="MBB">
                            </div>
                            {{ $.Scratch.Set "firstCarouselImage" false }}
                            {{ end }}
                        {{ end }}
                    {{ end }}
                </div>
            </div>
            <img class="logo" src="/assets/images/logo.svg" alt="Logo">
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <ul class="nav nav-pills nav-fill">
                {{ $currentPage := . }}
                {{ range .Site.Menus.main }}
                {{ if not (eq .Identifier "carousel") }}
                    <li class="nav-item">
                        <a class="nav-link {{if or ($currentPage.IsMenuCurrent "main" .) ($currentPage.HasMenuCurrent "main" .) }} active{{end}}" href="{{.URL}}">{{ .Name }}</a>
                    </li>
                {{ end }}
                {{ end }}
            </ul>
        </div>
    </div>
    <div class="row">
        <div class="col-md-8">
            {{ block "main" . }}
            {{ end }}
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title">Next Gig</h2>
                    {{ range first 1 (where (where .Site.Pages "Section" "=" "gigs").ByDate "Date" ">=" now) }}
                    <p class="card-text">{{.Date.Format "January 2, 3:04 PM"}}<br><a href="https://www.google.com/maps/place/?q=place_id:{{.Params.googleid}}">{{.Params.where}}</a><br>${{ if isset .Params "price" }}{{ index .Params "price" }}{{else}}10{{ end }} entry<br>{{.Content}}</p>
                    {{end}}
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <p class="footer float-right">
                <iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2FMainlandBigBand%2F&width=62&layout=button&action=like&size=large&show_faces=false&share=false&height=65&appId"
                        width="62" height="28" style="border:none;overflow:hidden" scrolling="no" frameborder="0"
                        allowTransparency="true"></iframe>
                <a class="contact-us" href="mailto:info@mainlandbigband.co.nz">
                    <svg fill="#d83f39" height="36" viewBox="0 0 24 24" width="36" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        <path d="M0 0h24v24H0z" fill="none"/>
                    </svg></a>
            </p>
        </div>
    </div>

</div>
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js" integrity="sha384-feJI7QwhOS+hwpX2zkaeJQjeiwlhOP+SdQDqhgvvo1DsjtiSQByFdThsxO669S2D" crossorigin="anonymous"></script>

<script>
    window.addEventListener('load', function() {
        document.querySelectorAll('.lazy-carousel-item img').forEach(function(image) {
            var lazySrc = image.getAttribute('data-lazy-src');
            var lazySrcSet = image.getAttribute('data-lazy-srcset');
            if (lazySrc) {
                image.setAttribute('src', lazySrc);
                image.setAttribute('srcset', lazySrcSet);
                image.removeAttribute('data-lazy-src');
                image.removeAttribute('data-lazy-srcset');
                var classList = image.parentNode.classList;
                classList.remove('lazy-carousel-item');
                classList.add('carousel-item');
                
            }
        });
    })
</script>
</body>
</html>